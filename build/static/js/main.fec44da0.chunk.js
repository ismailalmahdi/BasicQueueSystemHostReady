(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{23:function(e,t,n){},34:function(e,t,n){e.exports=n(67)},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(32),s=n.n(o),i=(n(39),n(4)),c=n(5),u=n(7),l=n(6),m=n(9),v=n(8),f=n(16),d=n(3),p=(n(40),r.a.createContext({booking:null,wishlist:[],countersOnline:[],toggleWishlist:function(){},toggleCounterStatus:function(){},addToCart:function(){},removeFromCart:function(){}})),h=(n(41),function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"text-light animate__animated animate__fadeIn"},r.a.createElement("div",{className:"cover-container d-flex w-100 h-100 p-3 mx-auto flex-column"},r.a.createElement("main",{className:"mb-auto"},r.a.createElement("div",{className:""},r.a.createElement("h1",{className:""},"Welcome to,"),r.a.createElement("h2",{className:"text-warning"},"Queue Ticketing System"),r.a.createElement("p",{className:"lead mr-md-3"},"This is a simple queue app "),r.a.createElement("p",{className:"text-warning"},r.a.createElement("u",null," I would like to start as a ")),r.a.createElement("p",{className:"lead"},r.a.createElement(f.b,{className:"btn btn-lg btn-secondary ",to:"/Customers"},"Customer"),r.a.createElement(f.b,{className:"btn btn-lg btn-secondary mx-4",to:"/Counters"},"Counter Manager"))))))}}]),t}(r.a.Component));h.context=p;var g=n(1),b=n.n(g),k=n(2),O=(n(23),n(48),n(49),n(13)),w=n.n(O),j=function(e){function t(e){var n;Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={last_issued_num:"None",latest_serving_num:"None"},y.getLatestServingCustomer().then(function(e){n.setState({latest_serving_num:e.results[0].id})}),y.getLatestQueueNumber().then(function(e){n.setState({last_issued_num:e.results[0].id})});var a=Object(m.a)(n);"serviceWorker"in navigator&&navigator.serviceWorker.register("./service-worker.js").then(function(){return navigator.serviceWorker.ready}).then(function(){navigator.serviceWorker.addEventListener("message",function(e){e.data&&void 0!==e.data.state&&a.setState({last_issued_num:e.data.state})})});a=Object(m.a)(n);return"serviceWorker"in navigator&&navigator.serviceWorker.register("./service-worker.js").then(function(){return navigator.serviceWorker.ready}).then(function(){navigator.serviceWorker.addEventListener("message",function(e){e.data&&void 0!==e.data.lastServed&&a.setState({latest_serving_num:e.data.lastServed})})}),n}return Object(v.a)(t,e),Object(c.a)(t,[{key:"takeANumber",value:function(){var e=Object(k.a)(b.a.mark(function e(t){var n=this;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:y.CustomerTakeANumber().then(function(e){navigator.serviceWorker&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({state:e.id}),n.setState({last_issued_num:e.id})});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"col d-flex text-center mx-auto p-5 "},r.a.createElement("div",{className:"  mx-auto p-5 card animate__animated animate__fadeIn "},r.a.createElement("h2",null," Now serving : ",this.state.latest_serving_num," "),r.a.createElement("h2",null," Last number : ",this.state.last_issued_num," "),r.a.createElement("button",{className:"btn btn-lg btn-warning",onClick:function(t){return e.takeANumber(t)}},"Take a Number")))}}]),t}(r.a.Component);var y={retrieveWishlist:function(){var e=Object(k.a)(b.a.mark(function e(){var t;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return e([1])}));case 3:return t=e.sent,e.abrupt("return",new Promise(function(e){w.a.get("/api/v1/wishlist/",t).then(function(t){e(t.data)})}));case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),retrieveCounterList:function(){var e=Object(k.a)(b.a.mark(function e(t,n){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(a={}).params=n,a.params.page=t,e.abrupt("return",new Promise(function(e){w.a.get("/api/v1/counters/",a).then(function(t){console.log(t.data),e(t.data)})}));case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),getNextCounterInQueue:function(){var e=Object(k.a)(b.a.mark(function e(t){var n=this;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){w.a.get("api/v1/customers/?search=PN&&limit=1").then(function(a){if(a.data.results.length>0){try{n.updateCustomerStatus(t.customer,"SR")}catch(r){}n.updateCounterNextCustomer(t.id,a.data.results[0].id),n.updateCustomerStatus(a.data.results[0].id,"SR"),e(a.data)}e({results:[{id:"Queue Empty"}]})})}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),getLatestServingCustomer:function(){var e=Object(k.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){w.a.get("api/v1/customers/?ordering=-id&search=SR&limit=1").then(function(t){t.data.results.length>0&&e(t.data),e({results:[{id:"None"}]})})}));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),getLatestQueueNumber:function(){var e=Object(k.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){w.a.get("api/v1/customers/?ordering=-id&limit=1").then(function(t){t.data.results.length>0&&e(t.data),e({results:[{id:"None"}]})})}));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),updateCounterNextCustomer:function(){var e=Object(k.a)(b.a.mark(function e(t,n){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){var a={customer:n};return w.a.patch("api/v1/counters/".concat(t,"/"),a)}));case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),updateCustomerStatus:function(){var e=Object(k.a)(b.a.mark(function e(t,n){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){var a={status:n};return w.a.patch("api/v1/customers/".concat(t,"/"),a)}));case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),CustomerTakeANumber:function(){var e=Object(k.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){w.a.post("api/v1/customers/new").then(function(t){e(t.data)})}));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),counterStatus:function(){var e=Object(k.a)(b.a.mark(function e(t,n){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){var a="ON";n||(a="OF");var r={id:t,status:a};return w.a.patch("api/v1/counters/".concat(t,"/"),r)}));case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),counterOnlineStatus:function(){var e=Object(k.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.customer=null,e.abrupt("return",new Promise(function(e){w.a.patch("api/v1/counters/".concat(t.id,"/"),t).then(function(t){e(t.data)})}));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},x=function(e){function t(e){var n;Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={data:n.props.item};var a=Object(m.a)(n);return"serviceWorker"in navigator&&navigator.serviceWorker.register("./service-worker.js").then(function(){return navigator.serviceWorker.ready}).then(function(){navigator.serviceWorker.addEventListener("message",function(e){e.data&&void 0!==e.data.counterData&&e.data.counterData.id==a.state.data.id&&a.setState({data:e.data.counterData})})}),n}return Object(v.a)(t,e),Object(c.a)(t,[{key:"setCounterStatusOnline",value:function(){var e=Object(k.a)(b.a.mark(function e(t){var n,a=this;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.state.data).status="ON",y.counterOnlineStatus(n).then(function(e){console.log(e),a.setState({data:e}),navigator.serviceWorker&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({counterData:e})});case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setCounterStatusOffline",value:function(){var e=Object(k.a)(b.a.mark(function e(t){var n,a=this;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.state.data).status="OF",y.counterOnlineStatus(n).then(function(e){console.log(e),a.setState({data:e}),navigator.serviceWorker&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({counterData:e})});case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return"OF"===this.state.data.status?r.a.createElement("button",{className:"btn btn-lg btn-success",onClick:function(t){return e.setCounterStatusOnline(t)}},"Go Online"):r.a.createElement("button",{className:"btn btn-lg btn-danger",onClick:function(t){return e.setCounterStatusOffline(t)}},"Go Offline")}}]),t}(r.a.Component),C=function(e){function t(e){var n;Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).onClickNexCustomer=function(e,t){var a=n.state.data;a.status="ON",y.counterOnlineStatus(a).then(function(e){console.log(e),n.setState({data:e}),navigator.serviceWorker&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({counterData:e})}).then(function(){y.getNextCounterInQueue(n.props.item).then(function(e){t.customer=e.results[0].id,navigator.serviceWorker&&navigator.serviceWorker.controller&&(navigator.serviceWorker.controller.postMessage({counterData:t}),navigator.serviceWorker.controller.postMessage({lastServed:t.customer})),n.setState({data:t}),console.log(e.results[0])})})},n.state={data:n.props.item};var a=Object(m.a)(n);return"serviceWorker"in navigator&&navigator.serviceWorker.register("./service-worker.js").then(function(){return navigator.serviceWorker.ready}).then(function(){navigator.serviceWorker.addEventListener("message",function(e){e.data&&void 0!==e.data.counterData&&(console.log(e.data.counterData),e.data.counterData.id==a.state.data.id&&("queue empty"===e.data.counterData.customer.toLowerCase()&&(e.data.counterData.customer=null),a.setState({data:e.data.counterData})))})}),n}return Object(v.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"card p-5 m-2"},r.a.createElement("h2",{className:"text-center mb-5"},"Counter  ",this.state.data.id),r.a.createElement(x,{item:this.state.data,goOfflineAction:this.props.goOfflineAction,goOnlineAction:this.props.goOnlineAction}),r.a.createElement("h1",{className:"text-center my-5"},this.state.data.customer),r.a.createElement("button",{className:"btn btn-warning",onClick:function(t){return e.onClickNexCustomer(t,e.state.data)}},"Next Customer"))}}]),t}(r.a.Component),E=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={list:[],pageIndex:1,totalItems:0},n.updateList(),n}return Object(v.a)(t,e),Object(c.a)(t,[{key:"updateList",value:function(){var e=this,t=this.state,n=t.pageIndex;t.filters;y.retrieveCounterList(n,{}).then(function(t){var n=t.results,a=t.count;e.setState({list:n,totalItems:a})})}},{key:"goOnlineAction",value:function(){var e=Object(k.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Go Online "+t.id),e.next=3,this.context.setCounterStatusOnline(t);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"goOfflineAction",value:function(){var e=Object(k.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Go Offline "+t.id),e.next=3,this.context.setCounterStatusOffline(t);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"nextCustomerAction",value:function(){var e=Object(k.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.list;return r.a.createElement("section",{className:"animate__animated animate__fadeIn"},r.a.createElement("header",null),r.a.createElement("section",{className:"container"},r.a.createElement("div",{className:"row"},t.map(function(t){return r.a.createElement("div",{key:t.id,className:"col"},r.a.createElement(C,{item:t,nextCustomerAction:e.nextCustomerAction.bind(e),goOfflineAction:e.goOfflineAction.bind(e),goOnlineAction:e.goOnlineAction.bind(e)}))}))))}}]),t}(r.a.Component);E.contextType=p;var N=function(e){function t(e){var n;Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={data:n.props.item};var a=Object(m.a)(n);return"serviceWorker"in navigator&&navigator.serviceWorker.register("./service-worker.js").then(function(){return navigator.serviceWorker.ready}).then(function(){navigator.serviceWorker.addEventListener("message",function(e){e.data&&void 0!==e.data.counterData&&e.data.counterData.id==a.state.data.id&&a.setState({data:e.data.counterData})})}),n}return Object(v.a)(t,e),Object(c.a)(t,[{key:"counterStatus",value:function(){return"OF"===this.state.data.status?r.a.createElement("span",{className:"bg-secondary text-secondary rounded-circle p-2 "},"......"):this.state.data.customer?r.a.createElement("span",{className:"bg-danger text-danger rounded-circle p-2 "},"......"):r.a.createElement("span",{className:"bg-success text-success rounded-circle p-2"},"......")}},{key:"render",value:function(){return r.a.createElement("div",{className:"p-4 m-2 card text-center"},r.a.createElement("div",{className:"pb-2"},this.counterStatus()),r.a.createElement("h5",{className:"my-4"}," Counter ",this.props.item.id," "),r.a.createElement("h1",null," ",this.state.data.customer," "))}}]),t}(r.a.Component),S=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={list:[],pageIndex:1,totalItems:0},n.updateList(),n}return Object(v.a)(t,e),Object(c.a)(t,[{key:"updateList",value:function(){var e=this,t=this.state,n=t.pageIndex;t.filters;y.retrieveCounterList(n,{}).then(function(t){var n=t.results,a=t.count;e.setState({list:n,totalItems:a})})}},{key:"goOnlineAction",value:function(){var e=Object(k.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Go Online "+t.id),e.next=3,this.context.setCounterStatusOnline(t);case 3:this.props.history.push("/Counters");case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"goOfflineAction",value:function(){var e=Object(k.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Go Offline "+t.id),e.next=3,this.context.setCounterStatusOffline(t);case 3:this.props.history.push("/Customers");case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.list;return r.a.createElement("section",{className:"animate__animated animate__fadeIn"},r.a.createElement("header",null),r.a.createElement("section",{className:"container"},r.a.createElement(j,null),r.a.createElement("div",{className:"row"},e.map(function(e){return r.a.createElement("div",{key:e.id,className:"col"},r.a.createElement(N,{item:e}))}))))}}]),t}(r.a.Component);S.contextType=p;var W=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={item:null,setCounterStatusOnline:n.setCounterStatusOnline.bind(Object(m.a)(n)),setCounterStatusOffline:n.setCounterStatusOffline.bind(Object(m.a)(n))},n}return Object(v.a)(t,e),Object(c.a)(t,[{key:"setCounterStatusOnline",value:function(e){var t=this;return new Promise(function(n){y.counterStatus(e.id,!0).then(function(){t.setState({item:e}),navigator.serviceWorker&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({counterData:e}),n(e)})})}},{key:"setCounterStatusOffline",value:function(e){var t=this;return new Promise(function(n){y.counterStatus(e.id,!1).then(function(){t.setState({item:e}),navigator.serviceWorker&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({counterData:e}),n(e)})})}},{key:"render",value:function(){return r.a.createElement(f.a,null,r.a.createElement("div",{className:"App"},r.a.createElement("nav",{className:""},r.a.createElement("div",{className:"App-nav__main"},r.a.createElement(f.c,{className:"btn mx-4 p-2 text-light",to:"/"},"Queue Ticketing System"),r.a.createElement("p",{className:"mx-4 p-2 text-light"},"V1.0 by Ismail AL.Mahdy")),r.a.createElement("div",{className:"App-nav__links"})),r.a.createElement("section",{className:"App-content"},r.a.createElement(p.Provider,{value:this.state},r.a.createElement(d.a,{path:"/",exact:!0,component:h}),r.a.createElement(d.a,{path:"/Counters",exact:!0,component:E}),r.a.createElement(d.a,{path:"/Customers",exact:!0,component:S})))))}}]),t}(r.a.Component),_=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function A(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}s.a.render(r.a.createElement(W,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");_?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):A(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):A(t,e)})}}()}},[[34,1,2]]]);
//# sourceMappingURL=main.fec44da0.chunk.js.map